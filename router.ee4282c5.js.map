{"version":3,"file":"router.ee4282c5.js","sources":["../node_modules/@greenwood/cli/src/lib/router.js"],"sourcesContent":["/* eslint-disable no-underscore-dangle */\n\n// ** THIS DOES NOT WORK ON SAFARI **\n// It will just load pages as if staticRouter was not enabled\ndocument.addEventListener('click', function(e) {\n  const href = (e.path && e.path[0]\n    ? e.path[0].href // chrome + edge\n    : e.originalTarget && e.originalTarget.href\n      ? e.originalTarget.href // firefox\n      : '') || '';\n  // best case \"guess\" is that if the link originates on the current site when resolved by the browser\n  // treat it as a client side route, ex:  /about/, /docs/ and trigger the client side router\n  // https://github.com/ProjectEvergreen/greenwood/issues/562\n  const isOnCurrentDomain = href.indexOf(window.location.hostname) >= 0 || href.indexOf('localhost') >= 0;\n  const canClientSideRoute = href !== '' && isOnCurrentDomain;\n\n  if (canClientSideRoute) {\n    e.preventDefault();\n\n    const targetUrl = new URL(href, window.location.origin);\n    const routerOutlet = Array.from(document.getElementsByTagName('greenwood-route')).filter(outlet => {\n      return outlet.getAttribute('data-route') === targetUrl.pathname;\n    })[0];\n\n    // maintain the app shell if we are navigating between pages that are built from the same page template\n    // also, some routes may be SSR, so we may not always match on a static route\n    if (routerOutlet && routerOutlet.getAttribute('data-template') === window.__greenwood.currentTemplate) {\n      \n      // only update the hash if it just the hash changing\n      // else, request and load the partial for the page, and push page to the browser history stack\n      if (targetUrl.hash !== '') {\n        location = targetUrl.hash;\n      } else {\n        routerOutlet.loadRoute();\n        history.pushState({}, '', targetUrl.pathname);\n      }\n    } else {\n      // this page uses is a completely different page template from the current page\n      // so just load the new page\n      window.location.href = href;\n    }\n  }\n});\n\nwindow.addEventListener('popstate', () => {\n  try {\n    const targetRoute = window.location;\n    const routerOutlet = Array.from(document.getElementsByTagName('greenwood-route')).filter(outlet => {\n      return outlet.getAttribute('data-route') === targetRoute.pathname;\n    })[0];\n\n    if (routerOutlet) {\n      routerOutlet.loadRoute();\n    }\n  } catch (err) {\n    console.error('Unexpected error trying to go back.', err);\n  }\n});\n\nclass RouteComponent extends HTMLElement {\n  loadRoute() {\n    const key = this.getAttribute('data-key');\n\n    fetch(key)\n      .then(res => res.text())\n      .then((response) => {\n        document.getElementsByTagName('router-outlet')[0].innerHTML = response;\n      });\n  }\n}\n\nclass RouterOutletComponent extends HTMLElement { }\n\ncustomElements.define('greenwood-route', RouteComponent);\ncustomElements.define('router-outlet', RouterOutletComponent);"],"names":["document","addEventListener","e","href","path","originalTarget","isOnCurrentDomain","indexOf","window","location","hostname","preventDefault","targetUrl","URL","origin","routerOutlet","Array","from","getElementsByTagName","filter","outlet","getAttribute","pathname","__greenwood","currentTemplate","hash","loadRoute","history","pushState","targetRoute","err","console","error","RouteComponent","HTMLElement","key","this","fetch","then","res","text","response","innerHTML","RouterOutletComponent","customElements","define"],"mappings":"AAIAA,SAASC,iBAAiB,SAAS,SAASC,GAC1C,MAAMC,GAAQD,EAAEE,MAAQF,EAAEE,KAAK,GAC3BF,EAAEE,KAAK,GAAGD,KACVD,EAAEG,gBAAkBH,EAAEG,eAAeF,KACnCD,EAAEG,eAAeF,KACjB,KAAO,GAIPG,EAAoBH,EAAKI,QAAQC,OAAOC,SAASC,WAAa,GAAKP,EAAKI,QAAQ,cAAgB,EAGtG,GAFoC,KAATJ,GAAeG,EAElB,CACtBJ,EAAES,iBAEF,MAAMC,EAAY,IAAIC,IAAIV,EAAMK,OAAOC,SAASK,QAC1CC,EAAeC,MAAMC,KAAKjB,SAASkB,qBAAqB,oBAAoBC,QAAOC,GAChFA,EAAOC,aAAa,gBAAkBT,EAAUU,WACtD,GAICP,GAAgBA,EAAaM,aAAa,mBAAqBb,OAAOe,YAAYC,gBAI7D,KAAnBZ,EAAUa,KACZhB,SAAWG,EAAUa,MAErBV,EAAaW,YACbC,QAAQC,UAAU,GAAI,GAAIhB,EAAUU,WAKtCd,OAAOC,SAASN,KAAOA,MAK7BK,OAAOP,iBAAiB,YAAY,KAClC,IACE,MAAM4B,EAAcrB,OAAOC,SACrBM,EAAeC,MAAMC,KAAKjB,SAASkB,qBAAqB,oBAAoBC,QAAOC,GAChFA,EAAOC,aAAa,gBAAkBQ,EAAYP,WACxD,GAECP,GACFA,EAAaW,YAEf,MAAOI,GACPC,QAAQC,MAAM,sCAAuCF,OAIzD,MAAMG,UAAuBC,YAC3BR,YACE,MAAMS,EAAMC,KAAKf,aAAa,YAE9BgB,MAAMF,GACHG,MAAKC,GAAOA,EAAIC,SAChBF,MAAMG,IACLzC,SAASkB,qBAAqB,iBAAiB,GAAGwB,UAAYD,MAKtE,MAAME,UAA8BT,aAEpCU,eAAeC,OAAO,kBAAmBZ,GACzCW,eAAeC,OAAO,gBAAiBF"}